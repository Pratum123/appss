<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>ЁЯУЪ рд╡рд┐рд╖рдп рдЪрдпрди</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f6fb;
      margin: 0;
      padding: 0;
    }
    header {
      background: #3949ab;
      color: white;
      padding: 15px;
      font-size: 22px;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .container {
      max-width: 500px;
      margin: 20px auto;
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #3949ab;
      font-size: 20px;
      margin: 10px 0;
    }
    select, input, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 14px;
      box-sizing: border-box;
    }
    .btn {
      background: #3949ab;
      color: white;
      font-weight: bold;
      border: none;
      cursor: pointer;
      padding: 10px;
      margin: 5px 0;
    }
    .section {
      margin-bottom: 20px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 12px;
    }
    h3 {
      font-size: 16px;
      color: #333;
      margin: 5px 0 10px 0;
      text-align: center;
    }
    .settings-link {
      text-align: center;
      margin: 10px 0;
    }
    .settings-link a {
      background: #3949ab;
      color: white;
      padding: 6px 12px;
      border-radius: 6px;
      text-decoration: none;
      font-weight: bold;
      display: inline-block;
      font-size: 14px;
    }
    .tab-container {
      display: flex;
      margin-bottom: 15px;
    }
    .tab {
      flex: 1;
      text-align: center;
      padding: 8px;
      background: #e0e0e0;
      cursor: pointer;
      border-radius: 5px 5px 0 0;
      margin: 0 2px;
    }
    .tab.active {
      background: #3949ab;
      color: white;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
  </style>
</head>
<body>
  <header>ЁЯУЪ Quiz App</header>

  <div class="settings-link">
    <a href="settings.html">тЪЩя╕П рд╕реЗрдЯрд┐рдВрдЧреНрд╕</a>
  </div>

  <div class="container">
    <h1>ЁЯУЪ рд╡рд┐рд╖рдп рдФрд░ рдЙрдкрд╡рд┐рд╖рдп рдЪрдпрди</h1>

    <div class="tab-container">
      <div class="tab active" onclick="switchTab('select')">рд╡рд┐рд╖рдп рдЪрдпрди</div>
      <div class="tab" onclick="switchTab('add')">рдирдпрд╛ рдЬреЛрдбрд╝реЗрдВ</div>
      <div class="tab" onclick="switchTab('manage')">рдкреНрд░рдмрдВрдзрди</div>
      <div class="tab" onclick="switchTab('backup')">рдмреИрдХрдЕрдк</div>
    </div>

    <!-- рд╡рд┐рд╖рдп рдЪрдпрди -->
    <div id="select-tab" class="tab-content active">
      <div class="section">
        <label><strong>рдореБрдЦреНрдп рд╡рд┐рд╖рдп:</strong></label>
        <select id="mainSubject" onchange="populateSubSubjects()"></select>

        <label><strong>рдЙрдкрд╡рд┐рд╖рдп:</strong></label>
        <select id="subSubject"></select>

        <button class="btn" onclick="proceedToAction()">ЁЯСЙ рдЖрдЧреЗ рдмрдврд╝реЗрдВ</button>
      </div>
    </div>

    <!-- рдирдпрд╛ рд╡рд┐рд╖рдп рдЬреЛрдбрд╝реЗрдВ -->
    <div id="add-tab" class="tab-content">
      <div class="section">
        <input id="newMain" placeholder="рдореБрдЦреНрдп рд╡рд┐рд╖рдп">
        <input id="newSubs" placeholder="рдЙрдкрд╡рд┐рд╖рдп (рдХреЙрдорд╛ рд╕реЗ рдЕрд▓рдЧ рдХрд░реЗрдВ)">
        <button class="btn" onclick="addNewSubject()">ЁЯУВ рдирдпрд╛ рд╡рд┐рд╖рдп рдЬреЛреЬреЗрдВ</button>
      </div>
    </div>

    <!-- рдЙрдкрд╡рд┐рд╖рдп рдкреНрд░рдмрдВрдзрди -->
    <div id="manage-tab" class="tab-content">
      <div class="section">
        <select id="manageMain" onchange="populateSubList()"></select>
        <select id="subList"></select>
        <input id="newSubInput" placeholder="рдирдпрд╛ рдЙрдкрд╡рд┐рд╖рдп рдЬреЛрдбрд╝реЗрдВ">
        <button class="btn" onclick="addSub()">тЮХ рдЙрдкрд╡рд┐рд╖рдп рдЬреЛрдбрд╝реЗрдВ</button>
        <button class="btn" onclick="deleteSub()">ЁЯЧСя╕П рдЙрдкрд╡рд┐рд╖рдп рд╣рдЯрд╛рдПрдВ</button>
      </div>
    </div>

    <!-- рд▓реЛрдХрд▓ JSON Backup -->
    <div id="backup-tab" class="tab-content">
      <div class="section">
        <input type="file" id="importFile" accept=".json" onchange="importData()">
        <button class="btn" onclick="exportData()">ЁЯУе рдбреЗрдЯрд╛ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВ</button>
      </div>
    </div>
  </div>

<script>
let subjects = {};

window.onload = () => {
  if (!localStorage.getItem("quiz_subjects")) {
    localStorage.setItem("quiz_subjects", JSON.stringify({
      economics: ["Micro", "Macro"],
      history: ["Ancient", "Modern"],
      geography: ["India", "World"]
    }));
  }
  subjects = JSON.parse(localStorage.getItem("quiz_subjects") || "{}");
  populateDropdowns();
};

function switchTab(tabName) {
  // Hide all tab contents
  document.querySelectorAll('.tab-content').forEach(content => {
    content.classList.remove('active');
  });
  
  // Deactivate all tabs
  document.querySelectorAll('.tab').forEach(tab => {
    tab.classList.remove('active');
  });
  
  // Activate selected tab and content
  document.getElementById(tabName + '-tab').classList.add('active');
  document.querySelector(`.tab[onclick="switchTab('${tabName}')"]`).classList.add('active');
}

function capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}

function populateDropdowns() {
  const main = document.getElementById("mainSubject");
  const manage = document.getElementById("manageMain");

  // Reset
  main.innerHTML = "";
  manage.innerHTML = "";
  document.getElementById("subSubject").innerHTML = '<option value="">-- рдЙрдкрд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ --</option>';
  document.getElementById("subList").innerHTML = '<option value="">-- рдЙрдкрд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ --</option>';

  // Default options
  main.appendChild(new Option("-- рд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ --", ""));
  manage.appendChild(new Option("-- рд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ --", ""));

  for (let key in subjects) {
    main.appendChild(new Option(capitalize(key), key));
    manage.appendChild(new Option(capitalize(key), key));
  }
}

function populateSubSubjects() {
  const subject = document.getElementById("mainSubject").value;
  const subs = subjects[subject] || [];
  const subSelect = document.getElementById("subSubject");
  subSelect.innerHTML = "";
  subSelect.appendChild(new Option("-- рдЙрдкрд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ --", ""));
  subs.forEach(sub => {
    subSelect.appendChild(new Option(sub, sub));
  });
}

function populateSubList() {
  const subject = document.getElementById("manageMain").value;
  const list = document.getElementById("subList");
  list.innerHTML = "";
  list.appendChild(new Option("-- рдЙрдкрд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ --", ""));
  if (subjects[subject]) {
    subjects[subject].forEach(sub => {
      list.appendChild(new Option(sub, sub));
    });
  }
}

function addNewSubject() {
  const newMain = document.getElementById("newMain").value.trim().toLowerCase();
  const newSubs = document.getElementById("newSubs").value.split(',').map(s => s.trim()).filter(Boolean);
  if (!newMain || newSubs.length === 0) {
    alert("тЭЧ рдХреГрдкрдпрд╛ рд╡рд┐рд╖рдп рдФрд░ рдЙрдкрд╡рд┐рд╖рдп рднрд░реЗрдВ");
    return;
  }
  subjects[newMain] = newSubs;
  localStorage.setItem("quiz_subjects", JSON.stringify(subjects));
  document.getElementById("newMain").value = "";
  document.getElementById("newSubs").value = "";
  populateDropdowns();
  alert("тЬЕ рдирдпрд╛ рд╡рд┐рд╖рдп рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛!");
  switchTab('select');
}

function addSub() {
  const subject = document.getElementById("manageMain").value;
  const newSub = document.getElementById("newSubInput").value.trim();
  if (!subject || !newSub) {
    alert("тЭЧ рдХреГрдкрдпрд╛ рд╡рд┐рд╖рдп рдФрд░ рдЙрдкрд╡рд┐рд╖рдп рднрд░реЗрдВ");
    return;
  }
  if (!subjects[subject]) subjects[subject] = [];
  if (subjects[subject].includes(newSub)) {
    alert("тЪая╕П рдпрд╣ рдЙрдкрд╡рд┐рд╖рдп рдкрд╣рд▓реЗ рд╕реЗ рдореМрдЬреВрдж рд╣реИ");
    return;
  }
  subjects[subject].push(newSub);
  localStorage.setItem("quiz_subjects", JSON.stringify(subjects));
  document.getElementById("newSubInput").value = "";
  populateSubList();
  populateSubSubjects();
  alert("тЬЕ рдЙрдкрд╡рд┐рд╖рдп рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛!");
}

function deleteSub() {
  const subject = document.getElementById("manageMain").value;
  const sub = document.getElementById("subList").value;
  if (!subject || !sub) {
    alert("тЭЧ рдХреГрдкрдпрд╛ рд╡рд┐рд╖рдп рдФрд░ рдЙрдкрд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ");
    return;
  }
  subjects[subject] = subjects[subject].filter(s => s !== sub);
  localStorage.setItem("quiz_subjects", JSON.stringify(subjects));
  populateSubList();
  populateSubSubjects();
  alert("ЁЯЧСя╕П рдЙрдкрд╡рд┐рд╖рдп рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛!");
}

function proceedToAction() {
  const main = document.getElementById("mainSubject").value;
  const sub = document.getElementById("subSubject").value;
  if (!main || !sub) {
    alert("тЪая╕П рдХреГрдкрдпрд╛ рд╡рд┐рд╖рдп рдФрд░ рдЙрдкрд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ!");
    return;
  }
  localStorage.setItem("selectedMain", main);
  localStorage.setItem("selectedSub", sub);
  window.location.href = "action.html";
}

function importData() {
  const file = document.getElementById("importFile").files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    const data = JSON.parse(e.target.result);
    if (data.subjects) {
      localStorage.setItem("quiz_subjects", JSON.stringify(data.subjects));
      subjects = data.subjects;
    }
    if (data.main) localStorage.setItem("selectedMain", data.main);
    if (data.sub) localStorage.setItem("selectedSub", data.sub);
    if (data.quizData) {
      for (let key in data.quizData) {
        localStorage.setItem(key, JSON.stringify(data.quizData[key]));
      }
    }
    alert("тЬЕ рдбреЗрдЯрд╛ рд▓реЛрдб рд╣реБрдЖ!");
    populateDropdowns();
  };
  reader.readAsText(file);
}

function exportData() {
  const data = {
    subjects: subjects,
    main: localStorage.getItem("selectedMain"),
    sub: localStorage.getItem("selectedSub"),
    quizData: {}
  };
  
  // Add any additional quiz data you want to export
  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    if (key.startsWith("quiz_") && key !== "quiz_subjects") {
      data.quizData[key] = JSON.parse(localStorage.getItem(key));
    }
  }
  
  const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'quiz_backup_' + new Date().toISOString().slice(0,10) + '.json';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}
</script>
</body>
</html>
