<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üìö ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§§‡•ç‡§§‡§∞‡•Ä ‡§ê‡§™ - ‡§∏‡•Å‡§ß‡§æ‡§∞‡§ø‡§§ ‡§õ‡§µ‡§ø ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§®</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a1a2e, #16213e);
      min-height: 100vh;
      padding: 20px;
      color: #f0f0f0;
      line-height: 1.6;
    }
    
    header {
      background: linear-gradient(135deg, #0f3460, #1a1a2e);
      color: white;
      padding: 25px;
      font-size: 28px;
      text-align: center;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
      border-radius: 0 0 15px 15px;
      margin-bottom: 30px;
      position: relative;
      overflow: hidden;
      border-bottom: 4px solid #e94560;
    }
    
    header::before {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(233, 69, 96, 0.1) 0%, rgba(233, 69, 96, 0) 70%);
      transform: rotate(30deg);
    }
    
    .app-container {
      max-width: 900px;
      margin: 0 auto;
    }
    
    .section {
      background: rgba(26, 26, 46, 0.8);
      padding: 30px;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      margin: 30px auto;
      position: relative;
      overflow: hidden;
      transition: transform 0.3s ease;
      border: 1px solid rgba(233, 69, 96, 0.3);
    }
    
    .section:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
    }
    
    .section::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(90deg, #e94560, #0f3460);
    }
    
    h2, h3 {
      color: #e94560;
      text-align: center;
      margin-bottom: 25px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    h2 {
      font-size: 26px;
      position: relative;
      padding-bottom: 15px;
    }
    
    h2::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 4px;
      background: linear-gradient(90deg, #e94560, #0f3460);
      border-radius: 2px;
    }
    
    textarea, input, select {
      width: 100%;
      padding: 14px;
      margin: 10px 0;
      border-radius: 10px;
      border: 1px solid #444;
      font-size: 16px;
      transition: all 0.3s;
      font-family: inherit;
      background: rgba(15, 52, 96, 0.5);
      color: #fff;
    }
    
    textarea:focus, input:focus, select:focus {
      border-color: #e94560;
      box-shadow: 0 0 0 3px rgba(233, 69, 96, 0.3);
      outline: none;
    }
    
    ::placeholder {
      color: #aaa;
    }
    
    .btn {
      background: linear-gradient(135deg, #e94560, #c2334d);
      color: white;
      font-weight: bold;
      border: none;
      padding: 14px 25px;
      border-radius: 10px;
      font-size: 17px;
      cursor: pointer;
      margin-top: 15px;
      transition: all 0.3s;
      box-shadow: 0 4px 10px rgba(233, 69, 96, 0.3);
      display: block;
      width: 100%;
      position: relative;
      overflow: hidden;
    }
    
    .btn::after {
      content: "";
      position: absolute;
      top: -50%;
      left: -60%;
      width: 40%;
      height: 200%;
      background: linear-gradient(rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0));
      transform: rotate(25deg);
      transition: all 0.4s;
    }
    
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(233, 69, 96, 0.4);
    }
    
    .btn:hover::after {
      left: 120%;
    }
    
    .btn-option {
      display: block;
      width: 100%;
      text-align: left;
      padding: 14px 18px;
      border-radius: 10px;
      background: rgba(15, 52, 96, 0.5);
      border: 1px solid #444;
      margin: 10px 0;
      font-size: 17px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      overflow: hidden;
      color: #fff;
    }
    
    .btn-option:hover {
      background: rgba(15, 52, 96, 0.8);
      transform: translateX(5px);
      border-color: #e94560;
    }
    
    .btn-option::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 5px;
      background: #e94560;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .btn-option:hover::before {
      opacity: 1;
    }
    
    .explanation {
      margin-top: 25px;
      padding: 20px;
      border-radius: 10px;
      background: rgba(15, 52, 96, 0.5);
      line-height: 1.6;
      border-left: 4px solid #e94560;
    }
    
    .edit-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #FFC107;
      color: #000;
      border: none;
      padding: 5px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 14px;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      z-index: 10;
      transition: all 0.3s;
    }
    
    .edit-btn:hover {
      transform: rotate(15deg) scale(1.1);
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
    }
    
    .question-item {
      padding: 15px;
      border-radius: 10px;
      background: rgba(15, 52, 96, 0.3);
      margin: 10px 0;
      position: relative;
      transition: all 0.3s;
      border: 1px solid rgba(233, 69, 96, 0.2);
    }
    
    .question-item:hover {
      background: rgba(15, 52, 96, 0.5);
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .submit-btn {
      background: linear-gradient(135deg, #4CAF50, #388E3C);
    }
    
    .accuracy-display {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 36px;
      font-weight: bold;
      color: #e94560;
      text-align: center;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .question-container {
      position: relative;
      padding: 20px;
      background: rgba(15, 52, 96, 0.5);
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(233, 69, 96, 0.3);
    }
    
    .question-text {
      font-weight: bold;
      margin-bottom: 15px;
      font-size: 18px;
      color: #fff;
    }
    
    .statement {
      font-weight: normal;
      color: #ccc;
      margin: 8px 0;
      line-height: 1.5;
    }
    
    .image-preview-container {
      margin: 20px 0;
      text-align: center;
      width: 100%;
      height: 200px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      background: #000; /* Black background */
      position: relative;
      border: none !important; /* Remove border */
    }
    
    .image-preview {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      border-radius: 0; /* Remove border radius */
      border: none !important; /* Remove border */
    }
    
    .remove-image-btn {
      background: #e94560;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
      font-size: 14px;
      box-shadow: 0 2px 5px rgba(233, 69, 96, 0.3);
      transition: all 0.3s;
      position: absolute;
      bottom: 10px;
      right: 10px;
      z-index: 10;
    }
    
    .remove-image-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 3px 8px rgba(233, 69, 96, 0.4);
    }
    
    .upload-btn-wrapper {
      position: relative;
      overflow: hidden;
      display: inline-block;
      width: 100%;
    }
    
    .upload-btn {
      background: rgba(15, 52, 96, 0.5);
      color: #64b5f6;
      border: 2px dashed #64b5f6;
      padding: 15px;
      border-radius: 12px;
      font-size: 17px;
      font-weight: bold;
      cursor: pointer;
      text-align: center;
      margin: 15px 0;
      display: block;
      transition: all 0.3s;
    }
    
    .upload-btn:hover {
      background: rgba(15, 52, 96, 0.8);
      transform: translateY(-3px);
      border-color: #e94560;
      color: #e94560;
    }
    
    .upload-btn-wrapper input[type=file] {
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }
    
    .question-image-container {
      width: 100%;
      height: 40vh;
      min-height: 200px;
      max-height: 400px;
      margin: 20px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      background: #000; /* Black background */
      border: none !important; /* Remove border */
      border-radius: 0; /* Remove border radius */
      box-shadow: none; /* Remove shadow */
      position: relative;
    }
    
    .question-image {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      border: none !important; /* Remove border */
      border-radius: 0; /* Remove border radius */
    }
    
    #progress {
      background: rgba(15, 52, 96, 0.5);
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      font-weight: bold;
      font-size: 18px;
      color: #e94560;
      margin-bottom: 20px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(233, 69, 96, 0.3);
    }
    
    #gotoContainer {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      align-items: center;
    }
    
    #gotoInput {
      flex: 1;
      padding: 12px;
      border-radius: 8px;
    }
    
    #gotoBtn {
      width: auto;
      padding: 12px 20px;
    }
    
    .result-card {
      background: rgba(26, 26, 46, 0.9);
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(233, 69, 96, 0.3);
    }
    
    .result-content {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      justify-content: center;
      align-items: center;
      margin: 25px 0;
    }
    
    .stats-box {
      flex: 1;
      min-width: 250px;
      background: rgba(15, 52, 96, 0.5);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(233, 69, 96, 0.3);
    }
    
    .stats-box p {
      margin: 12px 0;
      font-size: 17px;
      display: flex;
      justify-content: space-between;
      color: #fff;
    }
    
    .stats-box strong {
      color: #e94560;
    }
    
    .chart-container {
      position: relative;
      width: 280px;
      height: 280px;
    }
    
    @media (max-width: 650px) {
      .section {
        padding: 20px;
      }
      
      .result-content {
        flex-direction: column;
      }
      
      .stats-box {
        width: 100%;
      }
      
      .question-image-container {
        height: 30vh;
        max-height: 300px;
      }
      
      header {
        font-size: 22px;
        padding: 20px;
      }
    }
    
    .footer-note {
      text-align: center;
      margin-top: 30px;
      color: #aaa;
      font-size: 14px;
      padding: 20px;
      border-top: 1px solid rgba(233, 69, 96, 0.2);
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="app-container">
  <header>üìö ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§§‡•ç‡§§‡§∞‡•Ä ‡§ê‡§™ - ‡§∏‡•Å‡§ß‡§æ‡§∞‡§ø‡§§ ‡§õ‡§µ‡§ø ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§®</header>
  <h2 id="pageTitle" style="text-align:center; color:#e94560;"></h2>

  <div id="inputSection" class="section" style="display:none;">
    <h3>‚ûï ‡§®‡§Ø‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h3>
    <textarea id="question" placeholder="‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§≤‡§ø‡§ñ‡•á‡§Ç (‡§™‡§π‡§≤‡•Ä ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø ‡§¨‡•ã‡§≤‡•ç‡§° ‡§¶‡§ø‡§ñ‡•á‡§ó‡•Ä)" rows="3"></textarea>
    
    <div class="upload-btn-wrapper">
      <div class="upload-btn">
        <span>üì∑ ‡§õ‡§µ‡§ø ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)</span>
      </div>
      <input type="file" id="imageUpload" accept="image/*">
    </div>
    
    <div class="image-preview-container">
      <img id="imagePreview" class="image-preview" alt="‡§õ‡§µ‡§ø ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§µ‡§≤‡•ã‡§ï‡§®">
      <button id="removeImageBtn" class="remove-image-btn" style="display:none;">‚ùå ‡§õ‡§µ‡§ø ‡§π‡§ü‡§æ‡§è‡§Ç</button>
    </div>
    
    <input id="optA" placeholder="‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ A">
    <input id="optB" placeholder="‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ B">
    <input id="optC" placeholder="‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ C">
    <input id="optD" placeholder="‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ D">
    <select id="correct">
      <option value="A">A</option>
      <option value="B">B</option>
      <option value="C">C</option>
      <option value="D">D</option>
    </select>
    <textarea id="explanation" placeholder="‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç (‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü)" rows="3"></textarea>
    <button class="btn" onclick="saveQuestion()">üìÇ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§π‡•á‡§ú‡•á‡§Ç</button>
    <div id="questionCount" style="margin-top:20px; font-weight:bold; text-align:center; color:#e94560;"></div>
    <div id="questionList" style="margin-top:20px;"></div>
  </div>

  <div id="practiceSection" class="section" style="display:none;">
    <h3>üéØ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</h3>
    <div id="progress"></div>
    <div id="gotoContainer">
      <input id="gotoInput" type="number" placeholder="‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
      <button id="gotoBtn" onclick="goToQuestion()" class="btn">üîç ‡§ú‡§æ‡§è‡§Ç</button>
    </div>
    <div id="quizQuestionContainer" style="margin-top:25px;">
      <div id="quizQuestion" class="question-container"></div>
    </div>
    <div id="quizOptions"></div>
  </div>

  <div id="resultSection" class="section" style="display:none;">
    <div class="result-card">
      <h3 style="text-align:center; color:#e94560;">üìä ‡§Ü‡§™‡§ï‡•á ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ</h3>
      <div class="result-content">
        <div class="stats-box">
          <p><strong>üìù ‡§ï‡•Å‡§≤ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®:</strong> <span id="totalQuestions">0</span></p>
          <p><strong>‚úÖ ‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞:</strong> <span id="correctAnswers">0</span></p>
          <p><strong>‚ùå ‡§ó‡§≤‡§§ ‡§â‡§§‡•ç‡§§‡§∞:</strong> <span id="incorrectAnswers">0</span></p>
          <p><strong>üìä ‡§∏‡§ü‡•Ä‡§ï‡§§‡§æ:</strong> <span id="accuracyPercent" style="font-weight:bold; color:#e94560;">0%</span></p>
        </div>
        <div class="chart-container">
          <canvas id="resultChart"></canvas>
          <div class="accuracy-display">
            <span id="bigAccuracy">0%</span>
            <div style="font-size:16px; color:#aaa;">‡§∏‡§ü‡•Ä‡§ï‡§§‡§æ</div>
          </div>
        </div>
      </div>
      <button class="btn" onclick="window.location.reload()" style="margin-top:30px;">
        üè† ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§™‡•á‡§ú ‡§™‡§∞ ‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç
      </button>
    </div>
  </div>
  
  <div class="footer-note">
    ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§§‡•ç‡§§‡§∞‡•Ä ‡§ê‡§™ - ‡§õ‡§µ‡§ø‡§Ø‡§æ‡§Å ‡§ï‡§æ‡§≤‡•á ‡§™‡•É‡§∑‡•ç‡§†‡§≠‡•Ç‡§Æ‡§ø ‡§™‡§∞ ‡§¨‡§ø‡§®‡§æ ‡§¨‡•â‡§∞‡•ç‡§°‡§∞ ‡§ï‡•á ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç
  </div>
</div>

<script>
let questions = [];
let currentQuestion = 0;
let correctCount = 0;
let incorrectCount = 0;
let editIndex = -1;
let currentImage = null;

// Initialize event listeners
document.getElementById("imageUpload").addEventListener("change", function(event) {
  const file = event.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      currentImage = e.target.result;
      document.getElementById("imagePreview").src = currentImage;
      document.getElementById("imagePreview").style.display = "block";
      document.getElementById("removeImageBtn").style.display = "block";
    };
    reader.readAsDataURL(file);
  }
});

document.getElementById("removeImageBtn").addEventListener("click", function() {
  currentImage = null;
  document.getElementById("imagePreview").src = "";
  document.getElementById("imagePreview").style.display = "none";
  document.getElementById("removeImageBtn").style.display = "none";
  document.getElementById("imageUpload").value = "";
});

// Save question function
function saveQuestion() {
  const q = document.getElementById("question").value.trim();
  const A = document.getElementById("optA").value.trim();
  const B = document.getElementById("optB").value.trim();
  const C = document.getElementById("optC").value.trim();
  const D = document.getElementById("optD").value.trim();
  const correct = document.getElementById("correct").value;
  const exp = document.getElementById("explanation").value.trim();
  
  if (!q || !A || !B || !C || !D || !correct) {
    alert("‚ùó ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§´‡§º‡•Ä‡§≤‡•ç‡§° ‡§≠‡§∞‡•á‡§Ç!");
    return;
  }
  
  const newQ = {
    question: q,
    options: { A, B, C, D },
    correct,
    explanation: exp,
    image: currentImage
  };
  
  if (editIndex >= 0) {
    questions[editIndex] = newQ;
    editIndex = -1;
    alert("‚úÖ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ!");
  } else {
    questions.push(newQ);
    alert("‚úÖ ‡§®‡§Ø‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡•ã‡§°‡§º‡§æ ‡§ó‡§Ø‡§æ!");
  }
  
  const currentKey = `quiz_${localStorage.getItem("selectedMain")}_${localStorage.getItem("selectedSub")}`;
  localStorage.setItem(currentKey, JSON.stringify(questions));
  
  // Reset form
  document.getElementById("question").value = '';
  document.getElementById("optA").value = '';
  document.getElementById("optB").value = '';
  document.getElementById("optC").value = '';
  document.getElementById("optD").value = '';
  document.getElementById("explanation").value = '';
  document.getElementById("correct").value = 'A';
  
  // Reset image fields
  currentImage = null;
  document.getElementById("imagePreview").src = "";
  document.getElementById("imagePreview").style.display = "none";
  document.getElementById("removeImageBtn").style.display = "none";
  document.getElementById("imageUpload").value = "";
  
  // Update UI
  document.getElementById("questionCount").textContent = `üî¢ ‡§ï‡•Å‡§≤ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: ${questions.length}`;
  showAllQuestions();
}

// Show all questions in list
function showAllQuestions() {
  const listDiv = document.getElementById("questionList");
  listDiv.innerHTML = '';
  
  if (questions.length === 0) {
    listDiv.innerHTML = '<div style="text-align:center; padding:20px; color:#aaa;">‚ùå ‡§ï‡•ã‡§à ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§</div>';
    return;
  }
  
  questions.forEach((q, index) => {
    const div = document.createElement("div");
    div.className = "question-item";
    div.innerHTML = `
      <div style="position:relative;">
        <button class="edit-btn" onclick="editQuestion(${index})">‚úèÔ∏è</button>
        <div class="question-text">‡§™‡•ç‡§∞‡§∂‡•ç‡§® ${index + 1}: ${formatQuestionText(q.question)}</div>
        ${q.image ? '<div style="font-size:14px; color:#e94560; margin-top:10px;">üì∑ ‡§õ‡§µ‡§ø ‡§ú‡•Å‡§°‡§º‡•Ä ‡§π‡•Å‡§à ‡§π‡•à</div>' : ''}
      </div>
    `;
    listDiv.appendChild(div);
  });
}

// Format question text with bold first line
function formatQuestionText(text) {
  const parts = text.split('\n');
  let result = `<strong>${parts[0]}</strong>`;
  
  if (parts.length > 1) {
    for (let i = 1; i < parts.length; i++) {
      if (parts[i].trim() !== '') {
        result += `<div class="statement">${parts[i]}</div>`;
      }
    }
  }
  
  return result;
}

// Edit question
function editQuestion(index) {
  const q = questions[index];
  document.getElementById("question").value = q.question;
  document.getElementById("optA").value = q.options.A;
  document.getElementById("optB").value = q.options.B;
  document.getElementById("optC").value = q.options.C;
  document.getElementById("optD").value = q.options.D;
  document.getElementById("correct").value = q.correct;
  document.getElementById("explanation").value = q.explanation;
  
  if (q.image) {
    currentImage = q.image;
    document.getElementById("imagePreview").src = q.image;
    document.getElementById("imagePreview").style.display = "block";
    document.getElementById("removeImageBtn").style.display = "block";
  } else {
    currentImage = null;
    document.getElementById("imagePreview").style.display = "none";
    document.getElementById("removeImageBtn").style.display = "none";
  }
  
  editIndex = index;
  
  document.getElementById("inputSection").style.display = "block";
  document.getElementById("practiceSection").style.display = "none";
  document.getElementById("pageTitle").textContent = "‚úèÔ∏è ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç";
  
  // Scroll to top
  window.scrollTo(0, 0);
}

// Edit current question in practice mode
function editCurrentQuestion() {
  const q = questions[currentQuestion];
  
  document.getElementById("inputSection").style.display = "block";
  document.getElementById("practiceSection").style.display = "none";
  
  document.getElementById("question").value = q.question;
  document.getElementById("optA").value = q.options.A;
  document.getElementById("optB").value = q.options.B;
  document.getElementById("optC").value = q.options.C;
  document.getElementById("optD").value = q.options.D;
  document.getElementById("correct").value = q.correct;
  document.getElementById("explanation").value = q.explanation;
  
  if (q.image) {
    currentImage = q.image;
    document.getElementById("imagePreview").src = q.image;
    document.getElementById("imagePreview").style.display = "block";
    document.getElementById("removeImageBtn").style.display = "block";
  } else {
    currentImage = null;
    document.getElementById("imagePreview").style.display = "none";
    document.getElementById("removeImageBtn").style.display = "none";
  }
  
  editIndex = currentQuestion;
  document.getElementById("pageTitle").textContent = "‚úèÔ∏è ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç";
  
  // Scroll to top
  window.scrollTo(0, 0);
}

// Go to specific question
function goToQuestion() {
  const input = parseInt(document.getElementById("gotoInput").value);
  if (!input || input < 1 || input > questions.length) {
    alert(`‚ö†Ô∏è ‡§ï‡•É‡§™‡§Ø‡§æ 1 ‡§∏‡•á ${questions.length} ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§è‡§ï ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç`);
    return;
  }
  currentQuestion = input - 1;
  showQuestion();
}

// Show current question in practice mode
function showQuestion() {
  const q = questions[currentQuestion];
  
  let imageHTML = '';
  if (q.image) {
    imageHTML = `
      <div class="question-image-container">
        <img src="${q.image}" class="question-image" alt="‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§õ‡§µ‡§ø">
      </div>
    `;
  }
  
  const quizQuestionHTML = `
    <div id="quizQuestion" class="question-container">
      <button class="edit-btn" onclick="editCurrentQuestion()">‚úèÔ∏è</button>
      <div class="question-text">üìò ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ${currentQuestion + 1}/${questions.length}: ${formatQuestionText(q.question)}</div>
      ${imageHTML}
    </div>
  `;
  
  document.getElementById("quizQuestionContainer").innerHTML = quizQuestionHTML;
  
  const optionsDiv = document.getElementById("quizOptions");
  optionsDiv.innerHTML = '';
  
  for (let key in q.options) {
    const btn = document.createElement("button");
    btn.className = "btn-option";
    btn.textContent = `${key}: ${q.options[key]}`;
    btn.onclick = () => handleAnswer(key);
    optionsDiv.appendChild(btn);
  }
  
  const submitBtn = document.createElement("button");
  submitBtn.textContent = "‚úÖ ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§¶‡•á‡§ñ‡•á‡§Ç";
  submitBtn.className = "btn submit-btn";
  submitBtn.onclick = () => {
    if (confirm(`‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?\n‡§Ü‡§™‡§®‡•á ${correctCount + incorrectCount} ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§Ç ‡§ï‡•á ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡§ø‡§è ‡§π‡•à‡§Ç‡•§`)) {
      submitQuiz();
    }
  };
  optionsDiv.appendChild(submitBtn);
  
  document.getElementById("progress").textContent = `üìò ‡§™‡•ç‡§∞‡§ó‡§§‡§ø: ${currentQuestion + 1} / ${questions.length}`;
}

// Handle user answer
function handleAnswer(selected) {
  const q = questions[currentQuestion];
  const optionsDiv = document.getElementById("quizOptions");
  
  document.querySelectorAll(".btn-option").forEach(btn => btn.disabled = true);
  
  for (let btn of optionsDiv.children) {
    const key = btn.textContent[0];
    if (key === q.correct) {
      btn.style.backgroundColor = "#4CAF50";
      btn.style.color = "white";
    } else if (key === selected) {
      btn.style.backgroundColor = "#F44336";
      btn.style.color = "white";
    }
  }
  
  const expl = document.createElement("div");
  expl.className = "explanation";
  expl.innerHTML = `<strong>üìò ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ:</strong><br>${(q.explanation || '‡§á‡§∏ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à').replace(/\n/g, "<br>")}`;
  optionsDiv.appendChild(expl);
  
  if (selected === q.correct) {
    correctCount++;
  } else {
    incorrectCount++;
  }
  
  const nextBtn = document.createElement("button");
  nextBtn.textContent = currentQuestion < questions.length - 1 ? "‚û°Ô∏è ‡§Ö‡§ó‡§≤‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®" : "‚úÖ ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç";
  nextBtn.className = "btn";
  nextBtn.style.marginTop = "25px";
  nextBtn.onclick = () => {
    currentQuestion++;
    if (currentQuestion >= questions.length) submitQuiz();
    else showQuestion();
  };
  optionsDiv.appendChild(nextBtn);
}

// Submit quiz and show results
function submitQuiz() {
  const totalAnswered = correctCount + incorrectCount;
  const totalQuestions = questions.length;
  const accuracyPercent = totalAnswered > 0 ? Math.round((correctCount / totalAnswered) * 100) : 0;
  
  document.getElementById("totalQuestions").textContent = totalQuestions;
  document.getElementById("correctAnswers").textContent = correctCount;
  document.getElementById("incorrectAnswers").textContent = incorrectCount;
  document.getElementById("accuracyPercent").textContent = `${accuracyPercent}%`;
  document.getElementById("bigAccuracy").textContent = `${accuracyPercent}%`;
  
  const ctx = document.getElementById('resultChart').getContext('2d');
  new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: ['‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞', '‡§ó‡§≤‡§§ ‡§â‡§§‡•ç‡§§‡§∞'],
      datasets: [{
        data: [correctCount, incorrectCount],
        backgroundColor: ['#4CAF50', '#F44336'],
        borderWidth: 0,
        hoverOffset: 15
      }]
    },
    options: {
      cutout: '65%',
      plugins: {
        legend: {
          position: 'bottom',
          labels: {
            font: {
              size: 14
            }
          }
        }
      },
      animation: {
        animateRotate: true,
        animateScale: true
      }
    }
  });
  
  document.getElementById("practiceSection").style.display = "none";
  document.getElementById("resultSection").style.display = "block";
  
  // Scroll to results
  document.getElementById("resultSection").scrollIntoView({ behavior: 'smooth' });
}

// Initialize quiz
function populateQuiz() {
  const main = localStorage.getItem("selectedMain");
  const sub = localStorage.getItem("selectedSub");
  const mode = localStorage.getItem("quizMode") || "practice";
  const currentKey = `quiz_${main}_${sub}`;
  
  questions = JSON.parse(localStorage.getItem(currentKey) || '[]');
  currentQuestion = 0;
  correctCount = 0;
  incorrectCount = 0;
  editIndex = -1;
  currentImage = null;
  
  document.getElementById("pageTitle").textContent = mode === "input" ? "‚ûï ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç" : "üéØ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§§‡•ç‡§§‡§∞‡•Ä ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏";
  
  if (mode === "input") {
    document.getElementById("inputSection").style.display = "block";
    document.getElementById("questionCount").textContent = `üî¢ ‡§ï‡•Å‡§≤ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: ${questions.length}`;
    showAllQuestions();
  } else {
    if (questions.length === 0) {
      alert("‚ùó ‡§á‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ!");
      document.getElementById("inputSection").style.display = "block";
      document.getElementById("pageTitle").textContent = "‚ûï ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç";
      document.getElementById("questionCount").textContent = `üî¢ ‡§ï‡•Å‡§≤ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: 0`;
      showAllQuestions();
    } else {
      document.getElementById("practiceSection").style.display = "block";
      showQuestion();
    }
  }
}

// Initialize the app
window.onload = function() {
  // For demo purposes - initialize localStorage if not set
  if (!localStorage.getItem("selectedMain")) {
    localStorage.setItem("selectedMain", "demo");
    localStorage.setItem("selectedSub", "demo");
    localStorage.setItem("quizMode", "input");
  }
  
  populateQuiz();
  
  // Add some sample questions if empty
  if (questions.length === 0) {
    questions = [
      {
        question: "HTML ‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§∏ ‡§ü‡•à‡§ó ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§™‡•à‡§∞‡§æ‡§ó‡•ç‡§∞‡§æ‡§´ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à?",
        options: {
          A: "<p>",
          B: "<para>",
          C: "<paragraph>",
          D: "<pg>"
        },
        correct: "A",
        explanation: "HTML ‡§Æ‡•á‡§Ç ‡§™‡•à‡§∞‡§æ‡§ó‡•ç‡§∞‡§æ‡§´ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è <p> ‡§ü‡•à‡§ó ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§",
        image: null
      },
      {
        question: "CSS ‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§∏ ‡§™‡•ç‡§∞‡•â‡§™‡§∞‡•ç‡§ü‡•Ä ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§ï‡§æ ‡§∞‡§Ç‡§ó ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à?",
        options: {
          A: "text-color",
          B: "font-color",
          C: "color",
          D: "text-style"
        },
        correct: "C",
        explanation: "CSS ‡§Æ‡•á‡§Ç ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§ï‡§æ ‡§∞‡§Ç‡§ó ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 'color' ‡§™‡•ç‡§∞‡•â‡§™‡§∞‡•ç‡§ü‡•Ä ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§",
        image: null
      },
      {
        question: "JavaScript ‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§∏ ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§Ç‡§∏‡•ã‡§≤ ‡§™‡§∞ ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à?",
        options: {
          A: "print()",
          B: "display()",
          C: "console.log()",
          D: "output()"
        },
        correct: "C",
        explanation: "JavaScript ‡§Æ‡•á‡§Ç ‡§ï‡§Ç‡§∏‡•ã‡§≤ ‡§™‡§∞ ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è console.log() ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§",
        image: null
      }
    ];
    
    const currentKey = `quiz_${localStorage.getItem("selectedMain")}_${localStorage.getItem("selectedSub")}`;
    localStorage.setItem(currentKey, JSON.stringify(questions));
    document.getElementById("questionCount").textContent = `üî¢ ‡§ï‡•Å‡§≤ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: ${questions.length}`;
    showAllQuestions();
  }
};
</script>
</body>
</html>
